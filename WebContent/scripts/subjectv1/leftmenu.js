define(["./utils","./menuitem","./tab","./config","text!./template/lefttree.html"],function(h,f,a,b,i){var j={getCnt:function(){return $("#content")},getUl:function(){return $("#left-menu-list")}},c={top:$(i).find("#left-tree-top-tpl").html(),item:$(i).find("#left-tree-item-tpl").html()};var d=function(k){$.ajax({type:"POST",url:eastcom.baseURL+"/loginExtension/getCurrentUserTreeResources",data:{rootMenuName:b.leftTreeParent,controlStatus:"false"},dataType:"json",success:function(m){if(h.validateAjaxRs(m,"左侧菜单加载失败")){if(m.data&&m.data.length){var l=f.create(m.data[0]);k(l)}}}})};var e=function(l){if(!l||!l.childs.length){return}var k=j.getUl().empty();$.each(l.childs,function(m,n){k.append(h.getTplDom(c.top,{nameCn:n.nameCn,image:n.image}));$.each(n.childs,function(q,o){var p=h.getTplDom(c.item,{id:o.getId(),nameCn:o.nameCn});k.append(p)})})};var g=function(){var k=j.getUl();k.on("click","li a",function(){var m=$(this).attr("id"),l=f.findMenu(m);a.add({menu:l})})};return{init:function(){if(h.isNotBlank(b.leftTreeParent)){j.getCnt().removeClass("hide-left-tree");g();d(e)}}}});