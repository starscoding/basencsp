var ThemePanel=function(){var f=null;var c=false;var e=false;var g=function(){var h=b();$("#center").append(h);d();f=h};var b=function(){var h=$('<div id="theme_panel" style="display:none; top: 0px;"></div>');h.append($('<div id="theme_slider" class="center"></div>'));h.append($('<div class="close"><a class="btn-black-a" hidefocus="hidefocus" onclick="jQuery(\'#theme\').click();" href="javascript:;">'+BUTTON_CLOSE+"</a></div>"));h.append($('<div class="bottom"></div>'));return h};var d=function(){jQuery.ajax({type:"POST",dataType:"json",url:Eastcom.baseURL+"/desktop/loadThemes",success:function(i){if(i&&i.success=="true"){var h=i.data;var j=$("#theme_panel #theme_slider");$.each(h,function(m,l){var n=Eastcom.baseURL+"/static/images/themes/icons/"+l.attribute;var k=$('<a class="theme_thumb" hidefocus="hidefocus" index="10"><img width="107" height="54" src="'+n+'"><span>'+l.label+"</span></a>");if(l.value==eastcom.getTheme()){k.addClass("current")}else{k.hover(function(){k.addClass("current")},function(){k.removeClass("current")})}k.data("theme",l.value);k.bind("click",function(){if(k.data("theme")!=eastcom.getTheme()){a(k.data("theme"))}});j.append(k)});j.css({height:(h.length/2)*75+50})}},error:function(i,k,j){var h=Eastcom.sprintf(LOAD_USER_RESOURCES_FAILURE,k);alert(h)}})};var a=function(h){if(!confirm(CHANGE_THEME_WARN)){return false}$("body").mask(MSG_DATA_OPTING);jQuery.ajax({type:"POST",dataType:"json",data:{theme:h},url:Eastcom.baseURL+"/desktop/updateUserTheme",success:function(i){if(i&&i.success=="true"){location.reload()}else{alert(i.msg);$("body").unmask()}},error:function(j,l,k){var i=Eastcom.sprintf(LOAD_USER_RESOURCES_FAILURE,l);$("body").unmask();alert(i)}})};this.getObj=function(){return f};this.show=function(){if(!e){e=true;f.slideDown(400,function(){e=false;c=true})}};this.hide=function(){if(!e){e=true;f.slideUp(400,function(){e=false;c=false})}};this.isShow=function(){return c};g()};