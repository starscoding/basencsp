Ext.ns("cis.repository.statLogByChart");cis.repository.statLogByChart.StatLogByLoginGrid=function(){Ext.define("slblg",{extend:"Ext.data.Model",fields:[{name:"username",type:"string"},{name:"usernameCn",type:"string"},{name:"count",type:"string"},{name:"deptName",type:"string"}]});var g=true;var a=Ext.create("Ext.data.Store",{model:"slblg",proxy:{type:"ajax",autoLoad:false,actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},url:eastcom.baseURL+"/extend/sysmng/statSysLogByLoginForChart",reader:{type:"json",root:"data.elements",totalProperty:"data.total"},params:{}},listeners:{load:function(){g=false}}});var d=[{header:"用户名",dataIndex:"usernameCn",align:"center",width:100},{header:"部门",dataIndex:"deptName",align:"center",width:100},{header:TOTALSUM,dataIndex:"count",align:"center",width:100}];var i=null;var c=null;var b=function(n,j){var k=(n=="all");var l=eastcom.baseURL+"/extend/sysmng/statexport?queryTotal="+k+"&fileType="+j;if(c!=null){for(var m in c){l+=("&"+m+"="+c[m])}}if(!k){if(i){l+=("&start="+(i.fromRecord-1)+"&limit="+PAGESIZE)}else{l+=("&start=0&limit="+PAGESIZE)}}l+="&type=count";window.open(encodeURI(l))};var f=Ext.create("Ext.components.ExportWin",{doExport:function(k,j){b(k,j)},getTotal:function(){if(i){return i.total}else{return 0}}});var e=Ext.create("Ext.PagingToolbar",{pageSize:PAGESIZE,store:a,displayInfo:true,listeners:{change:function(k,j){i=j}}});var h=Ext.create("Ext.grid.Panel",{id:"statLogByLoginGrid",border:false,tbar:["用户操作次数统计",{xtype:"tbfill"},{iconCls:"icon-xls",text:BUTTON_EXPORT,handler:function(){f.show()}},"-",{icon:"../../static/images/default/chart_bar.png",tooltip:"查看图表",handler:function(){Ext.getCmp("cardPanelLogin").getLayout().setActiveItem(0)}},"-",{icon:"../../static/images/default/data_list_num.png",tooltip:"查看表格数据",handler:function(){Ext.getCmp("cardPanelLogin").getLayout().setActiveItem(1)}}],store:a,colModel:d,bbar:e,height:"100%",autoScroll:true,autoShow:true,stripeRows:true,forceFit:true});this.getPanel=function(){return h};this.isNeedLoad=function(){return g};this.search=function(k){var j=a.getProxy();j.extraParams={dept:k.dept,startTime:k.startTime,endTime:k.endTime,user:k.user};a.load({params:{start:0,limit:e.pageSize}});c=k}};cis.repository.statLogByChart.ChartByLoginPlet=function(){var c=this;var a=null;var b=new cis.repository.statLogByChart.StatLogByLoginGrid();c.search=function(e){b.search(e)};c.setParams=function(e){a=e};var d=new Ext.Panel({region:"center",id:"cardPanelLogin",layout:"card",activeItem:0,items:[{tbar:["用户操作次数统计",{xtype:"tbfill"},{icon:"../../static/images/default/chart_bar.png",tooltip:"查看图表",handler:function(){Ext.getCmp("cardPanelLogin").getLayout().setActiveItem(0)}},"-",{icon:"../../static/images/default/data_list_num.png",tooltip:"查看表格数据",handler:function(){Ext.getCmp("cardPanelLogin").getLayout().setActiveItem(1);if(b.isNeedLoad()){if(a){c.search(a)}}}}],id:"chart04",frame:false,border:false,xtype:"panel",html:'<div id="chart04Container" style="height:100%;"></div>',anchor:"100% 50%"},b.getPanel()]});this.getPanel=function(){return d}};