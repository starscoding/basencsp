Ext.ns("cis.repository.statLogByChart");cis.repository.statLogByChart.GeneralLogInfoGrid=function(){Ext.define("glig",{extend:"Ext.data.Model",fields:[{name:"appHost",type:"string"},{name:"auditId",type:"string"},{name:"host",type:"string"},{name:"id",type:"string"},{name:"auditStatus",type:"string"},{name:"logTime",type:"string"},{name:"content",type:"string"},{name:"module",type:"string"},{name:"moduleCodeCn",type:"string"},{name:"operateType",type:"string"},{name:"qryusedtime",type:"string"},{name:"recordTime",type:"string"},{name:"username",type:"string"},{name:"username_cn",type:"string"}]});var h=true;var a=Ext.create("Ext.data.Store",{model:"glig",proxy:{type:"ajax",actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},url:eastcom.baseURL+"/extend/sysmng/qryGeneralLogInfo",reader:{type:"json",root:"data.elements",totalProperty:"data.total"},params:{deptName:"",startTime:"",endTime:"",start:"",limit:""}},listeners:{load:function(){h=false}}});var e=[{id:"module",header:MODULENAME,dataIndex:"moduleCodeCn",sortable:true,width:200,align:"center"},{id:"auditStatus",header:STATE,dataIndex:"auditStatus",sortable:true,renderer:i,align:"center"},{id:"username",header:OPERATOR,dataIndex:"username",sortable:true,align:"center"},{id:"host",header:IPADDRESS,dataIndex:"host",align:"center"},{id:"appHost",header:RESPONSESERVER,dataIndex:"appHost",align:"center"},{id:"recordTime",header:OPERATETIME,dataIndex:"recordTime",sortable:true,align:"center"},{id:"qryusedtime",header:USEDTIME,dataIndex:"qryusedtime",sortable:true,align:"center"}];function i(l,k){if(l=="0"){l="<font color=red>"+FAILURE+"</font>"}else{l="<font color=green>"+SUCCESSFUL+"</font>"}return l}var j=null;var d=null;var b=function(o,k){var l=(o=="all");var m=eastcom.baseURL+"/extend/sysmng/statexport?queryTotal="+l+"&fileType="+k;if(d!=null){for(var n in d){m+=("&"+n+"="+d[n])}}if(!l){if(j){m+=("&start="+(j.fromRecord-1)+"&limit="+PAGESIZE)}else{m+=("&start=0&limit="+PAGESIZE)}}m+="&type=time";window.open(encodeURI(m))};var g=Ext.create("Ext.components.ExportWin",{doExport:function(l,k){b(l,k)},getTotal:function(){if(j){return j.total}else{return 0}}});var c=Ext.create("Ext.components.BaseCommonPagingToolbar",{store:a,pageSize:PAGESIZE,listeners:{change:function(l,k){j=k}}});var f=Ext.create("Ext.grid.Panel",{id:"generalLogInfoGrid",border:false,tbar:["用户操作时间段统计",{xtype:"tbfill"},{iconCls:"icon-xls",text:BUTTON_EXPORT,handler:function(){g.show()}},"-",{icon:"../../static/images/default/chart_line.png",tooltip:"查看图表",handler:function(){Ext.getCmp("cardPanelGeneral").getLayout().setActiveItem(0)}},"-",{icon:"../../static/images/default/data_list_num.png",tooltip:"查看表格数据",handler:function(){Ext.getCmp("cardPanelGeneral").getLayout().setActiveItem(1)}}],store:a,colModel:e,bbar:c,stripeRows:true,autoScroll:true,autoShow:true,forceFit:true});this.getPanel=function(){return f};this.isNeedLoad=function(){return h};this.search=function(l){var k=a.getProxy();k.extraParams={dept:l.dept,loadStyle:l.loadStyle,startTime:l.startTime,endTime:l.endTime,user:l.user};a.load({params:{start:0,limit:c.pageSize}});d=l}};cis.repository.statLogByChart.GeneralLogInfoCurvePlet=function(){var d=this;var a=null;var c=new cis.repository.statLogByChart.GeneralLogInfoGrid();d.search=function(e){c.search(e)};d.setParams=function(e){a=e};var b=new Ext.Panel({region:"center",id:"cardPanelGeneral",layout:"card",activeItem:0,height:"100%",items:[{tbar:["用户操作时间段统计",{xtype:"tbfill"},{icon:"../../static/images/default/chart_line.png",tooltip:"查看图表",handler:function(){Ext.getCmp("cardPanelGeneral").getLayout().setActiveItem(0)}},"-",{icon:"../../static/images/default/data_list_num.png",tooltip:"查看表格数据",handler:function(){Ext.getCmp("cardPanelGeneral").getLayout().setActiveItem(1);if(c.isNeedLoad()){if(a){d.search(a)}}}}],id:"chart03",border:false,xtype:"panel",html:'<div id="chart03Container" style="height:100%;"></div>',anchor:"100% 50%"},c.getPanel()]});this.getPanel=function(){return b}};Ext.extend(cis.repository.statLogByChart.GeneralLogInfoCurvePlet,Ext.Panel,{});