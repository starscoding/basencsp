Ext.ns("cis.repository.statLogByChart");cis.repository.statLogByChart.StatLogByModuleGrid=function(){Ext.define("slbmg",{extend:"Ext.data.Model",fields:[{name:"moduleCode",type:"string"},{name:"moduleName",type:"string"},{name:"count",type:"string"}]});var g=true;var a=Ext.create("Ext.data.Store",{model:"slbmg",proxy:{type:"ajax",actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},url:eastcom.baseURL+"/extend/sysmng/searchLogsGroupByModule",reader:{type:"json",root:"data.elements",totalProperty:"data.total"},params:{}},listeners:{load:function(){g=false}}});var d=[{id:"moduleCode",header:MODULENAME,dataIndex:"moduleCode",align:"left",flex:1,sortable:true},{id:"moduleName",header:LOG_MODULE_NAME_CN,dataIndex:"moduleName",align:"left",flex:1,sortable:true},{id:"count",header:TOTALSUM,dataIndex:"count",width:100,align:"center"}];var i=null;var c=null;var b=function(n,j){var k=(n=="all");var l=eastcom.baseURL+"/extend/sysmng/statexport?queryTotal="+k+"&fileType="+j;if(c!=null){for(var m in c){l+=("&"+m+"="+c[m])}}if(!k){if(i){l+=("&start="+(i.fromRecord-1)+"&limit="+PAGESIZE)}else{l+=("&start=0&limit="+PAGESIZE)}}l+="&type=module";window.open(encodeURI(l))};var f=Ext.create("Ext.components.ExportWin",{doExport:function(k,j){b(k,j)},getTotal:function(){if(i){return i.total}else{return 0}}});var e=Ext.create("Ext.PagingToolbar",{pageSize:PAGESIZE,store:a,displayInfo:true,listeners:{change:function(k,j){i=j}}});var h=Ext.create("Ext.grid.Panel",{id:"statLogByModuleGrid",store:a,tbar:["用户操作模块统计",{xtype:"tbfill"},{iconCls:"icon-xls",text:BUTTON_EXPORT,handler:function(){f.show()}},"-",{icon:"../../static/images/default/chart_bar.png",tooltip:"查看图表",handler:function(){Ext.getCmp("cardPanelModule").getLayout().setActiveItem(0)}},"-",{icon:"../../static/images/default/data_list_num.png",tooltip:"查看表格数据",handler:function(){Ext.getCmp("cardPanelModule").getLayout().setActiveItem(1)}}],colModel:d,bbar:e,autoScroll:true,autoShow:true,stripeRows:true,border:false,forceFit:true});this.getPanel=function(){return h};this.isNeedLoad=function(){return g};this.search=function(k){var j=a.getProxy();j.extraParams={dept:k.dept,startTime:k.startTime,endTime:k.endTime,user:k.user};a.load({params:{start:0,limit:e.pageSize}});c=k}};cis.repository.statLogByChart.ChartByModulePlet=function(){var a=new cis.repository.statLogByChart.StatLogByModuleGrid();var d=this;var b=null;this.search=function(e){a.search(e)};d.setParams=function(e){b=e};var c=new Ext.Panel({region:"center",id:"cardPanelModule",layout:"card",activeItem:0,items:[{tbar:["用户操作模块统计",{xtype:"tbfill"},{icon:"../../static/images/default/chart_bar.png",tooltip:"查看图表",handler:function(){Ext.getCmp("cardPanelModule").getLayout().setActiveItem(0)}},"-",{icon:"../../static/images/default/data_list_num.png",tooltip:"查看表格数据",handler:function(){Ext.getCmp("cardPanelModule").getLayout().setActiveItem(1);if(a.isNeedLoad()){if(b){d.search(b)}}}}],id:"chart01",border:false,xtype:"panel",html:'<div id="chart01Container" style="height:100%;"></div>',anchor:"100% 50%"},a.getPanel()]});this.getPanel=function(){return c}};