Ext.Loader.setConfig({enabled:true});Ext.Loader.setPath("Ext.ux",extDir+"/ux");Ext.Loader.setPath("Ext.components","../../../../static/commonjs/components");Ext.Loader.setPath("Ext.role","../../../../scripts/personaldesktop");Ext.require(["Ext.form.*","Ext.data.*","Ext.grid.*","Ext.tree.*","Ext.ux.form.ValidatorTextField"]);eastcom.modules.shortcutMng=(function(){Ext.define("RESOURCES",{extend:"Ext.data.Model",fields:[{name:"id",type:"string"},{name:"name",type:"string"},{name:"nameCn",type:"string"}]});var d=Ext.create("Ext.data.TreeStore",{model:"RESOURCES",proxy:{type:"ajax",actionMethods:"POST",url:eastcom.baseURL+"/desktop/findMyShortcut",extraParams:{name:"",expanded:false}},sorters:{property:"order",direction:"ASC"},listeners:{load:function(){if(a&&a.getEl()){a.getEl().unmask()}}}});var e=Ext.create("Ext.Action",{iconCls:"icon-remove",disabled:true,text:BUTTON_DELETE,handler:function(g,f){var h=a.getSelectionModel().getSelection()[0];Ext.Msg.show({title:MSG_SURE,msg:"确定删除吗？",buttons:Ext.Msg.YESNO,icon:Ext.Msg.WARNING,fn:function(j){if(j=="yes"){var i=h.parentNode;if(h){var k=h.get("id");a.getEl().mask(DEL_DELETING);Ext.Ajax.request({url:eastcom.baseURL+"/desktop/deleteMyShortcut",timeout:60000,params:{resourceId:k},success:function(m){var n=m.responseText;var l=Ext.JSON.decode(n);if(l.success=="true"){b();h.remove();if(i){if(!i.isRoot()&&!i.isExpandable()){i.set("leaf",true)}}Ext.Msg.show({title:MSG_SUCCESS,msg:l.msg,buttons:Ext.Msg.OK,icon:Ext.Msg.INFO})}else{Ext.Msg.show({title:MSG_FAILURE,msg:l.msg,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}a.getEl().unmask()},failure:function(){Ext.Msg.show({title:MSG_FAILURE,msg:rslt.msg,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});a.getEl().unmask()}})}}}})}});function b(){var f=a.getView();f.getSelectionModel().deselectAll()}var a=Ext.create("Ext.tree.Panel",{region:"center",useArrows:true,fit:true,animate:false,stateful:true,rootVisible:false,store:d,autoHeight:true,enableColumnHide:eastcom.enableColumnHide,columns:[{xtype:"treecolumn",text:"我的快捷方式",width:"100%",sortable:false,dataIndex:"nameCn"}],dockedItems:[{xtype:"toolbar",items:[e]}],viewConfig:{overflowY:"auto",overflowX:"hidden",stripeRows:true,listeners:{itemcontextmenu:function(f,j,h,g,i){i.stopEvent();contextMenu.showAt(i.getXY());return false}},plugins:{ptype:"treeviewdragdrop",containerScroll:true}},listeners:{afterlayout:function(){var f=this;if(f.store&&f.store.isLoading()){f.getEl().mask(MSG_DATA_LOADING)}},selectionchange:function(g,f){if(f.length){e.enable()}else{e.disable()}},select:function(i,f,g,h){if(f){}}}});function c(){Ext.create("Ext.Viewport",{layout:{type:"border",padding:5},items:[a]})}return{initComponent:c}})();