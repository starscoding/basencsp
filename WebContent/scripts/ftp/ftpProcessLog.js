Ext.Loader.setConfig({enabled:true});Ext.Loader.setPath("Ext.ux",extDir+"/ux");Ext.Loader.setPath("Ext.inas","../../scripts/ftp/components");Ext.Loader.setPath("Ext.components",eastcom.baseURL+"/static/commonjs/components");Ext.require(["Ext.form.*","Ext.data.*","Ext.grid.*","Ext.tip.*","Ext.ux.RowExpander","Ext.components.BaseDataComboBox","Ext.components.BaseCommonPagingToolbar"]);eastcom.modules.inas=(function(){var l=null;var h=null;var g=Ext.create("Ext.data.Store",{fields:["name","value"],data:[{name:"上传",value:"1"},{name:"下载",value:"2"},{name:"删除",value:"3"}],toValue:function(m){if(m){var n=g.find("value",m,0,true,true,false);if(n>-1){return g.getAt(n).get("name")}else{return""}}}});var a=Ext.create("Ext.data.Store",{fields:["name","value"],data:[{name:"成功",value:"1"},{name:"失败",value:"0"}],toValue:function(m){if(m){var n=a.find("value",m,0,true,true,false);if(n>-1){return a.getAt(n).get("name")}else{return""}}}});Ext.define("ftpProcessLogResult",{extend:"Ext.data.Model",fields:[{name:"id",type:"string"},{name:"serialId",type:"string"},{name:"serverName",type:"string"},{name:"fileName",type:"string"},{name:"fileNameExt",type:"string"},{name:"startTime",type:"string"},{name:"endTime",type:"string"},{name:"operator",type:"string"},{name:"type",type:"int"},{name:"status",type:"int"},{name:"usedTime",type:"String"},{name:"clientIp",type:"string"},{name:"message",type:"string"}]});var e=Ext.create("Ext.inas.TypeComboBox",{id:"qryType",name:"type",labelAlign:"right",labelWidth:80,width:330,fieldLabel:"操作类型"});var c=Ext.create("Ext.inas.StatusComboBox",{id:"qryStatus",name:"status",labelAlign:"right",labelWidth:80,width:330,fieldLabel:"状态"});var j=Ext.create("Ext.data.Store",{pageSize:eastcom.pageSize,model:"ftpProcessLogResult",proxy:{type:"ajax",url:eastcom.baseURL+"/FtpProcessLogController/qryFtpProcessLog",reader:{type:"json",root:"data.elements",totalProperty:"data.total"},actionMethod:{read:"POST"},timeout:180000},listeners:{}});var d=[{text:"ID",dataIndex:"id",hidden:true},{text:"外部业务流水号",dataIndex:"serialId",align:"center",labelWidth:80,width:220},{text:"文件服务器名称",dataIndex:"serverName",align:"center",labelWidth:80,width:220},{text:"原始文件名",dataIndex:"fileName",align:"center",labelWidth:80,width:220},{text:"新文件名称",dataIndex:"fileNameExt",align:"center",labelWidth:80,width:220},{text:"开始时间",dataIndex:"startTime",align:"center",labelWidth:80,width:220},{text:"结束时间",dataIndex:"endTime",align:"center",labelWidth:80,width:220},{text:"操作人",dataIndex:"operator",align:"center",labelWidth:80,width:220},{text:"操作类型",dataIndex:"type",align:"center",labelWidth:80,width:220,renderer:g.toValue},{text:"状态",dataIndex:"status",align:"center",labelWidth:80,width:220,renderer:a.toValue},{text:"操作耗时",dataIndex:"usedTime",align:"center",labelWidth:80,width:220,},{text:"客户端IP",dataIndex:"clientIp",align:"center",labelWidth:80,width:220,},{text:"扩展信息",dataIndex:"message",align:"center",labelWidth:80,width:220,}];var i=Ext.create("Ext.grid.Panel",{id:"gridPanel",store:j,columns:d,autoShow:true,viewConfig:{loadMask:true},bbar:Ext.create("Ext.components.BaseCommonPagingToolbar",{store:j,listeners:{change:function(n,m){h=m}}}),afterrender:function(){Ext.tip.QuickTipManager.register({target:"userSearchInput",title:LABEL_TIPS+"：",text:USER_SEARCH_TIPS,width:100,dismissDelay:50000})},animCollapse:false,viewConfig:{forceFit:false,sortAscText:"正序",sortDescText:"降序",getRowClass:function(m,q,p,o){var n;if(m.data.pbxName==""){n="my_row_Red"}return n}},renderTo:Ext.getBody()});function b(){if(Ext.getCmp("ftpProcessLogForm").getForm().isValid()){var m=j.proxy;var n={serialId:Ext.getCmp("qrySerialId").getValue(),type:Ext.getCmp("qryType").getValue(),status:Ext.getCmp("qryStatus").getValue(),serverName:Ext.getCmp("qryServerName").getValue(),fileName:Ext.getCmp("qryFileName").getValue(),fileNameExt:Ext.getCmp("qryFileNameExt").getValue(),startTime:Ext.getCmp("qryStartTime").getValue(),endTime:Ext.getCmp("qryEndTime").getValue(),operator:Ext.getCmp("qryOperator").getValue(),usedTime:Ext.getCmp("qryUsedTime").getValue(),clientIp:Ext.getCmp("qryClientIp").getValue(),message:Ext.getCmp("qryMessage").getValue()};m.extraParams=n;j.loadPage(1,{start:0,limit:eastcom.pageSize,callback:function(){currentParam=n}})}}function f(){Ext.getCmp("ftpProcessLogForm").getForm().reset()}function k(){Ext.create("Ext.Viewport",{layout:{type:"border",padding:5},listeners:{},items:[{region:"center",layout:"fit",frame:false,border:false,items:[i]},{region:"north",padding:"0 0 5 0",bodyPadding:10,items:[Ext.create("Ext.form.Panel",{border:false,id:"ftpProcessLogForm",items:[{xtype:"fieldcontainer",layout:"hbox",defaults:{labelAlign:"right",labelWidth:100,width:330},items:[{xtype:"textfield",fieldLabel:"外部业务流水号",id:"qrySerialId"},e,c,{xtype:"button",style:"margin-left:20px",iconCls:"icon-search",width:60,text:BUTTON_SEARCH,handler:b},{xtype:"button",style:"margin-left:20px",formBind:false,width:70,text:BUTTON_RESET,handler:f}]},{xtype:"fieldset",checkboxToggle:true,collapsed:true,title:"更多条件",layout:"column",autoScroll:true,defaults:{layout:"anchor",border:false,defaults:{labelWidth:80,anchor:"95%",labelAlign:"right"}},items:[{columnWidth:1/3,defaultType:"textfield",items:[{xtype:"textfield",fieldLabel:"服务器名称",id:"qryServerName"},{xtype:"textfield",fieldLabel:"原始文件名",id:"qryFileName"},{xtype:"textfield",fieldLabel:"新文件名",id:"qryFileNameExt"}]},{columnWidth:1/3,defaultType:"textfield",items:[{xtype:"datefield",fieldLabel:"开始时间",format:"Y-m-d h:i:s",id:"qryStartTime"},{xtype:"datefield",fieldLabel:"结束时间",format:"Y-m-d h:i:s",id:"qryEndTime"},{xtype:"textfield",fieldLabel:"操作人",id:"qryOperator"}]},{columnWidth:1/3,defaultType:"textfield",items:[{xtype:"textfield",fieldLabel:"操作耗时",id:"qryUsedTime"},{xtype:"textfield",fieldLabel:"客户端IP",id:"qryClientIp"},{xtype:"textfield",fieldLabel:"扩展信息",id:"qryMessage"}]}]}]})]}]})}return{initComponent:k}})();