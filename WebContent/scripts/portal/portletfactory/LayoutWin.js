var LayoutWin=function(b){var g=this;var i=[];var e=b;var d={width:620,height:140,title:"模版",closeAction:"hide",content:""};var h=function(m){Ext.get(g.getBody()[0]).mask(MSG_DATA_SAVING);var r;switch(m){case"1":r=LAYOUT_1;break;case"2":r=LAYOUT_2;break;case"3":r=LAYOUT_3;break;case"4":r=LAYOUT_4;break;case"5":r=LAYOUT_5;break}var t=Ext.getCmp(e);var o=[];var n=t.layout.getLayoutItems();for(var q=0;q<n.length;q++){var k=n[q];var l=[];for(var p=0;p<k.layout.getLayoutItems().length;p++){var s=k.layout.getLayoutItems()[p];l.push(s.id)}o.push(l.join(","))}Ext.Ajax.request({url:eastcom.baseURL+"/portal/changeLayout",method:"POST",params:{portalId:t.portalId,columnWidth:r.columnWidth.join(","),colItemIds:o.join("-")},success:function(u,v){var j=Ext.JSON.decode(u.responseText);if(j.success=="true"){t.remoteLoadPortal()}else{Ext.Msg.show({title:MSG_FAILURE,msg:j.msg,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}Ext.get(g.getBody()[0]).unmask()},failure:function(j,u){Ext.Msg.show({title:MSG_ERROR,msg:MSG_ERROR_PROMPT,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR});Ext.get(g.getBody()[0]).unmask()}})};var a=function(k){var j='<ul class="box">';$.each(k,function(n,l){var m='<li id="'+l.id+'" name="layoutItem" title="'+l.desc+'">';m+="<a>";m+='<img width="48" height="48" align="absMiddle" src="'+(eastcom.baseURL+l.imageUrl)+'">';m+='<span class="lleft">';m+='<span class="lright">'+l.name+"</span>";m+="</span>";m+="</a>";m+="</li>";j+=m});j+="</ul>";return j};var c=function(){g.getBody().find("ul.box [name=layoutItem]").bind("click",function(){h($(this).attr("id"))})};var f=function(){$.ajax({type:"GET",dataType:"json",url:eastcom.baseURL+PORT_LAYOUT_JSON_URL,success:function(j){i=j.layout;var k=a(i);g.updateContent($(k));c()}})};CommonWindow.call(g,d);f();g.setPortalId=function(j){e=j};g.getPortalId=function(j){return e}};