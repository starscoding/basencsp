Ext.Loader.setConfig({enabled:true});Ext.Loader.setPath("Ext.ux",extDir+"/ux");Ext.Loader.setPath("Ext.components","../../static/commonjs/components");var required='<span style="color:red;font-weight:bold" data-qtip="Required">*</span>';Ext.define("SysMonitorND",{extend:"Ext.data.Model",fields:[{name:"id",type:"string"},{name:"mappingId",type:"string"},{name:"name",type:"string"},{name:"time",type:"string"},{name:"instanceName",type:"string"},{name:"value",type:"string"},{name:"alarmThreshold",type:"string"},{name:"alarmLevel",type:"string"},{name:"alarmInfo",type:"string"},{name:"remark",type:"string"}]});var monitorND=Ext.create("Ext.data.Store",{id:"monitorND",model:"SysMonitorND",pageSize:eastcom.pageSize,autoLoad:true,proxy:{type:"ajax",url:eastcom.baseURL+"/sysmonitor/querySysMonitorAlarmHistory",reader:{type:"json",idProperty:"oid",root:"data"},actionMethods:{read:"POST"},timeout:180000}});Ext.define("Ext.monitor.monitorHistoryInfoWin",{extend:"Ext.window.Window",requires:["Ext.form.*","Ext.window.*","Ext.grid.*","Ext.data.*","Ext.components.BaseDataComboBox","Ext.ux.RowExpander","Ext.components.DateTimeField"],baseCommonData:null,title:"历史监控统计",id:"monitorHistoryInfoWin",frame:false,layout:"fit",border:false,resizable:false,autoScroll:true,closeAction:"destroy",width:1080,height:currentUserTheme=="neptune"?445:425,listeners:{show:function(){Ext.getBody().mask()},close:function(){Ext.getBody().unmask()}},load:function(a){this["id"]=a.id;this["mappingId"]=a.mappingId;this["startTime"]=a.startTime;this["endTime"]=a.endTime;Ext.getCmp("startTime").setValue(this.startTime);Ext.getCmp("endTime").setValue(this.endTime);Ext.getStore("monitorND").load({params:{id:this.id,mappingId:this.mappingId,startTime:this.startTime,endTime:this.endTime}})},initSearchPanelComponent:function(){var b=this;var a=Ext.create("Ext.panel.Panel",{region:"north",padding:"0 0 5 0",height:50,layout:"hbox",bodyPadding:10,defaults:{labelAlign:"right",labelWidth:80,width:250,msgTarget:"side"},items:[{fieldLabel:"开始时间",xtype:"datetimefield",id:"startTime",endTimeField:{id:"endTime"},timeConfig:{},name:"startTime",emptyText:MSG_CHOOSE_ONE,labelAlign:"right",allowBlank:false,afterLabelTextTpl:required,anchor:"95%"},{fieldLabel:"结束时间",xtype:"datetimefield",id:"endTime",name:"endTime",emptyText:MSG_CHOOSE_ONE,startTimeField:{id:"startTime"},labelAlign:"right",allowBlank:false,afterLabelTextTpl:required,anchor:"100%"},{xtype:"button",style:"margin-left:20px",formBind:true,iconCls:"icon-search",width:60,text:BUTTON_SEARCH,handler:function(){var f=b.id;var e=b.mappingId;var d=Ext.getCmp("startTime").getValue();var c=Ext.getCmp("endTime").getValue();Ext.getStore("monitorND").load({params:{id:f,mappingId:e,startTime:d,endTime:c}})}},{xtype:"button",style:"margin-left:20px",formBind:true,iconCls:"icon-refresh",width:70,text:BUTTON_RESET,handler:function(){Ext.getCmp("startTime").setValue("");Ext.getCmp("endTime").setValue("")}}]});return a},initMonitorStatisticsGrid:function(){var b=this;var a=Ext.create("Ext.grid.Panel",{region:"center",id:"monitorStatisticsGrid",store:monitorND,columnLines:true,autoScroll:true,columns:[{text:INSTANCE_NAME,flex:1,dataIndex:"instanceName",sortable:false,align:"center"},{text:MONITOR_NAME,flex:1,sortable:false,dataIndex:"name",minWidth:250},{text:MONITOR_EDIT_TIME,flex:1,sortable:false,dataIndex:"time",minWidth:250},{text:MONITOR_VALUE_THR,sortable:false,flex:1,dataIndex:"value",align:"center"},{text:MONITOR_THRESHOLD,flex:1,dataIndex:"alarmThreshold",sortable:false,align:"center"},{text:MONITOR_ALARM_LEVEL,flex:1,dataIndex:"alarmLevel",sortable:false,align:"center"},{text:MONITOR_EXCEPTION,flex:1,dataIndex:"alarmInfo",sortable:false,align:"center"},{text:MONITOR_REMARK,flex:1,dataIndex:"remark",sortable:false,align:"center"}]});return a},initComponent:function(){var a=this;a.layout={type:"border",padding:5};a.items=[{region:"north",padding:"0 0 5 0",height:50,layout:"hbox",bodyPadding:10,defaults:{labelAlign:"right",labelWidth:80,width:250,msgTarget:"side"},items:[{fieldLabel:"开始时间",xtype:"datetimefield",id:"startTime",endTimeField:{id:"endTime"},timeConfig:{},name:"startTime",emptyText:MSG_CHOOSE_ONE,labelAlign:"right",allowBlank:false,afterLabelTextTpl:required,anchor:"95%"},{fieldLabel:"结束时间",xtype:"datetimefield",id:"endTime",name:"endTime",emptyText:MSG_CHOOSE_ONE,startTimeField:{id:"startTime"},labelAlign:"right",allowBlank:false,afterLabelTextTpl:required,anchor:"100%"},{xtype:"button",style:"margin-left:20px",formBind:true,iconCls:"icon-search",width:60,text:BUTTON_SEARCH,handler:function(){var e=a.id;var d=a.mappingId;var c=Ext.getCmp("startTime").getValue();var b=Ext.getCmp("endTime").getValue();Ext.getStore("monitorND").load({params:{id:e,mappingId:d,startTime:c,endTime:b}})}},{xtype:"button",style:"margin-left:20px",formBind:true,iconCls:"icon-refresh",width:70,text:BUTTON_RESET,handler:function(){Ext.getCmp("startTime").setValue("");Ext.getCmp("endTime").setValue("")}}]},a.initMonitorStatisticsGrid()];this.callParent()}});